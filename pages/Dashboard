import { useState } from "react";
import {
  FaHome, FaClock, FaChartBar, FaUser, FaUserShield, FaUsers,
  FaClipboardList, FaMoneyBillWave, FaProjectDiagram, FaEdit, FaSave, FaTimes
} from "react-icons/fa";

function Dashboard({ usuario, empleados, setEmpleados, proyectos, setProyectos }) {
  const [view, setView] = useState("dashboard");
  const [adminTab, setAdminTab] = useState("reportes");
  const esAdmin = usuario?.cargo === "administrador";
  const [salarios, setSalarios] = useState({
    "Juan Pérez": 500,
    "Ana Gómez": 450,
  });

  // Estados para proyectos
  const [editProyectoIdx, setEditProyectoIdx] = useState(null);
  const [editProyectoData, setEditProyectoData] = useState({ 
    nombre: "", 
    estado: "RELEVAMIENTO" 
  });

  // Estados para reportes y formularios
  const [reportes, setReportes] = useState([
    { empleado: "Juan Pérez", proyecto: "Proyecto A", horas: 40, fecha: "2025-01-05" },
    { empleado: "Ana Gómez", proyecto: "Proyecto B", horas: 35, fecha: "2025-01-05" },
  ]);

  const [formHoras, setFormHoras] = useState({
    proyecto: proyectos[0]?.nombre || "",
    horas: "",
    comentario: ""
  });

  // Estados para edición de empleados
  const [editEmpleadoIdx, setEditEmpleadoIdx] = useState(null);
  const [editEmpleadoData, setEditEmpleadoData] = useState({ 
    nombre: "", 
    email: "", 
    proyecto: proyectos[0]?.nombre || "" 
  });

  // Obtener fecha de hoy en formato YYYY-MM-DD
  const getFechaHoy = () => {
    const hoy = new Date();
    return hoy.toISOString().split('T')[0];
  };

  // Manejar carga de horas
  const handleCargarHoras = (e) => {
    e.preventDefault();
    if (!formHoras.proyecto || !formHoras.horas || formHoras.horas <= 0) {
      alert("Por favor completa todos los campos requeridos");
      return;
    }

    const nuevoReporte = {
      empleado: usuario.nombre,
      proyecto: formHoras.proyecto,
      horas: Number(formHoras.horas),
      fecha: getFechaHoy(),
      comentario: formHoras.comentario
    };

    setReportes(prev => [...prev, nuevoReporte]);
    
    setFormHoras({
      proyecto: proyectos[0]?.nombre || "",
      horas: "",
      comentario: ""
    });

    alert("Horas cargadas exitosamente");
  };

  // Calcular dedicación por proyecto
  const dedicacionPorProyecto = proyectos.map(proy => ({
    ...proy,
    empleados: empleados
      .filter(e => e.proyecto === proy.nombre)
      .map(e => {
        const horas = reportes.find(r => r.empleado === e.nombre && r.proyecto === proy.nombre)?.horas || 0;
        return { nombre: e.nombre, horas };
      })
  }));

  // Funciones para estados de proyectos
  const estadosProyecto = [
    "RELEVAMIENTO", "ANALISIS", "DISEÑO", "DESARROLLO", "TESTEO", "COMPLETADO"
  ];

  const getEstadoColor = (estado) => {
    const index = estadosProyecto.indexOf(estado);
    const progress = (index / (estadosProyecto.length - 1)) * 100;
    
    // Rojo a Verde basado en el progreso
    const red = Math.floor(255 * (1 - progress / 100));
    const green = Math.floor(255 * (progress / 100));
    return `rgb(${red}, ${green}, 0)`;
  };

  const getEstadoProgreso = (estado) => {
    const index = estadosProyecto.indexOf(estado);
    return ((index + 1) / estadosProyecto.length) * 100;
  };

  // Funciones para edición de proyectos
  const handleEditProyecto = (idx) => {
    setEditProyectoIdx(idx);
    setEditProyectoData({ ...proyectos[idx] });
  };

  const handleSaveProyecto = () => {
    setProyectos(proys =>
      proys.map((proy, idx) =>
        idx === editProyectoIdx ? { ...editProyectoData } : proy
      )
    );
    setEditProyectoIdx(null);
  };

  const handleCancelEditProyecto = () => {
    setEditProyectoIdx(null);
  };

  // Funciones para empleados (existentes)
  const handleEditEmpleado = idx => {
    setEditEmpleadoIdx(idx);
    setEditEmpleadoData({ ...empleados[idx] });
  };

  const handleSaveEmpleado = () => {
    setEmpleados(emps =>
      emps.map((emp, idx) =>
        idx === editEmpleadoIdx ? { ...editEmpleadoData } : emp
      )
    );
    setEditEmpleadoIdx(null);
  };

  const handleCancelEdit = () => {
    setEditEmpleadoIdx(null);
  };

  const handleSalarioChange = (nombre, valor) => {
    setSalarios(prev => ({
      ...prev,
      [nombre]: Number(valor)
    }));
  };

  return (
    <div className="flex-row">
      {/* Sidebar Navigation */}
      <aside className="sidebar">
        <button onClick={() => setView("dashboard")} className={view === "dashboard" ? "active" : ""}>
          <FaHome /> Inicio
        </button>
        <button onClick={() => setView("horas")} className={view === "horas" ? "active" : ""}>
          <FaClock /> Cargar Horas
        </button>
        <button onClick={() => setView("reportes")} className={view === "reportes" ? "active" : ""}>
          <FaChartBar /> Reportes
        </button>
        <button onClick={() => setView("proyectos")} className={view === "proyectos" ? "active" : ""}>
          <FaProjectDiagram /> Proyectos
        </button>
        <button onClick={() => setView("perfil")} className={view === "perfil" ? "active" : ""}>
          <FaUser /> Perfil
        </button>
        {esAdmin && (
          <button onClick={() => setView("admin")} className={view === "admin" ? "active" : ""}>
            <FaUserShield /> Administrador
          </button>
        )}
      </aside>

      {/* Main Content */}
      <main className="main-content">
        {/* Dashboard */}
        {view === "dashboard" && (
          <div>
            <h2 style={{ color: "#7c3aed", fontWeight: "bold", marginBottom: 24 }}>Panel Principal</h2>
            <div className="grid" style={{ gridTemplateColumns: "1fr", gap: "24px" }}>
              {/* Reportes rápidos */}
              <div className="card" style={{ maxWidth: "100%" }}>
                <div style={{ display: "flex", alignItems: "center", gap: 12, marginBottom: 16 }}>
                  <FaChartBar style={{ fontSize: 28, color: "#7c3aed" }} />
                  <span style={{ fontWeight: "bold", fontSize: "1.1rem" }}>Reportes rápidos</span>
                </div>
                <table>
                  <thead>
                    <tr>
                      <th>Empleado</th>
                      <th>Proyecto</th>
                      <th>Horas</th>
                    </tr>
                  </thead>
                  <tbody>
                    {reportes.map((r, idx) => (
                      <tr key={idx}>
                        <td>{r.empleado}</td>
                        <td>{r.proyecto}</td>
                        <td>{r.horas}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
              
              {/* Cargar horas */}
              <div className="card" style={{ maxWidth: "100%" }}>
                <div style={{ display: "flex", alignItems: "center", gap: 12, marginBottom: 16 }}>
                  <FaClock style={{ fontSize: 28, color: "#7c3aed" }} />
                  <span style={{ fontWeight: "bold", fontSize: "1.1rem" }}>Cargar horas</span>
                </div>
                <form onSubmit={handleCargarHoras}>
                  <select 
                    className="select" 
                    value={formHoras.proyecto}
                    onChange={e => setFormHoras(prev => ({ ...prev, proyecto: e.target.value }))}
                    required
                  >
                    {proyectos.map((p, i) => (
                      <option key={i} value={p.nombre}>{p.nombre}</option>
                    ))}
                  </select>
                  <input 
                    type="date" 
                    className="input" 
                    value={getFechaHoy()} 
                    readOnly 
                    style={{ backgroundColor: "#f3f4f6", cursor: "not-allowed" }}
                  />
                  <input 
                    type="number" 
                    className="input" 
                    placeholder="Horas trabajadas" 
                    min="1" 
                    value={formHoras.horas}
                    onChange={e => setFormHoras(prev => ({ ...prev, horas: e.target.value }))}
                    required
                  />
                  <textarea 
                    className="input" 
                    placeholder="Comentario (opcional)" 
                    rows={2} 
                    style={{ resize: "vertical" }}
                    value={formHoras.comentario}
                    onChange={e => setFormHoras(prev => ({ ...prev, comentario: e.target.value }))}
                  />
                  <button className="button button-green" type="submit">Guardar</button>
                </form>
              </div>
              
              {/* Empleados */}
              <div className="card" style={{ maxWidth: "100%" }}>
                <div style={{ display: "flex", alignItems: "center", gap: 12, marginBottom: 16 }}>
                  <FaUsers style={{ fontSize: 28, color: "#7c3aed" }} />
                  <span style={{ fontWeight: "bold", fontSize: "1.1rem" }}>Empleados</span>
                </div>
                <table>
                  <thead>
                    <tr>
                      <th>Nombre</th>
                      <th>Email</th>
                      <th>Proyecto</th>
                      {esAdmin && <th>Acciones</th>}
                    </tr>
                  </thead>
                  <tbody>
                    {empleados.map((e, idx) => (
                      <tr key={idx}>
                        <td>{e.nombre}</td>
                        <td>{e.email}</td>
                        <td>{e.proyecto}</td>
                        {esAdmin && (
                          <td>
                            <button className="button" style={{ width: "auto", padding: "6px 12px", fontSize: "0.9rem" }}
                              onClick={() => handleEditEmpleado(idx)}
                            >Editar</button>
                            <button className="button button-green" style={{ width: "auto", padding: "6px 12px", fontSize: "0.9rem", marginLeft: "6px" }}>Eliminar</button>
                          </td>
                        )}
                      </tr>
                    ))}
                  </tbody>
                </table>
                {/* Formulario de edición de empleados */}
                {esAdmin && editEmpleadoIdx !== null && (
                  <div className="card" style={{ marginTop: 24, background: "#ede9fe" }}>
                    <h2 style={{ color: "#7c3aed" }}>Editar Empleado</h2>
                    <input
                      className="input"
                      value={editEmpleadoData.nombre}
                      onChange={e => setEditEmpleadoData(data => ({ ...data, nombre: e.target.value }))}
                      placeholder="Nombre"
                    />
                    <input
                      className="input"
                      value={editEmpleadoData.email}
                      onChange={e => setEditEmpleadoData(data => ({ ...data, email: e.target.value }))}
                      placeholder="Email"
                    />
                    <select
                      className="select"
                      value={editEmpleadoData.proyecto}
                      onChange={e => setEditEmpleadoData(data => ({ ...data, proyecto: e.target.value }))}
                    >
                      {proyectos.map((p, i) => (
                        <option key={i} value={p.nombre}>{p.nombre}</option>
                      ))}
                    </select>
                    <div style={{ display: "flex", gap: 12 }}>
                      <button className="button" style={{ width: "auto" }} onClick={handleSaveEmpleado}>Guardar</button>
                      <button className="button button-green" style={{ width: "auto" }} onClick={handleCancelEdit}>Cancelar</button>
                    </div>
                  </div>
                )}
              </div>
            </div>
          </div>
        )}

        {/* Proyectos */}
        {view === "proyectos" && (
          <div className="table-container">
            <h2>Proyectos y Dedicación</h2>
            {dedicacionPorProyecto.map((proy, idx) => (
              <div key={idx} className="card" style={{ marginBottom: "24px", padding: "20px" }}>
                <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: "16px" }}>
                  <h3 style={{ color: "#7c3aed", margin: 0 }}>
                    <FaProjectDiagram style={{ marginRight: 6 }} /> {proy.nombre}
                  </h3>
                  <span 
                    style={{ 
                      backgroundColor: getEstadoColor(proy.estado),
                      color: "white",
                      padding: "4px 12px",
                      borderRadius: "20px",
                      fontSize: "0.9rem",
                      fontWeight: "bold"
                    }}
                  >
                    {proy.estado}
                  </span>
                </div>
                
                {/* Barra de progreso del estado */}
                <div style={{ marginBottom: "16px" }}>
                  <div style={{ 
                    display: "flex", 
                    justifyContent: "space-between", 
                    fontSize: "0.8rem", 
                    marginBottom: "8px",
                    color: "#666"
                  }}>
                    <span>RELEVAMIENTO</span>
                    <span>COMPLETADO</span>
                  </div>
                  <div style={{ 
                    width: "100%", 
                    height: "8px", 
                    backgroundColor: "#e5e7eb", 
                    borderRadius: "4px",
                    overflow: "hidden"
                  }}>
                    <div 
                      style={{ 
                        width: `${getEstadoProgreso(proy.estado)}%`, 
                        height: "100%", 
                        backgroundColor: getEstadoColor(proy.estado),
                        transition: "all 0.3s ease"
                      }} 
                    />
                  </div>
                  <div style={{ 
                    display: "flex", 
                    justifyContent: "space-between", 
                    fontSize: "0.7rem", 
                    marginTop: "4px",
                    color: "#999"
                  }}>
                    {estadosProyecto.map((estado, i) => (
                      <span key={i}>{estado.substring(0, 3)}</span>
                    ))}
                  </div>
                </div>

                {/* Empleados asignados */}
                <table style={{ marginTop: "16px" }}>
                  <thead>
                    <tr>
                      <th>Empleado</th>
                      <th>Horas dedicadas</th>
                    </tr>
                  </thead>
                  <tbody>
                    {proy.empleados.length === 0 ? (
                      <tr>
                        <td colSpan={2}>Sin empleados asignados</td>
                      </tr>
                    ) : (
                      proy.empleados.map((emp, i) => (
                        <tr key={i}>
                          <td>{emp.nombre}</td>
                          <td>{emp.horas}</td>
                        </tr>
                      ))
                    )}
                  </tbody>
                </table>
              </div>
            ))}
          </div>
        )}

        {/* Cargar horas */}
        {view === "horas" && (
          <div className="card" style={{ maxWidth: 500 }}>
            <h2>Registrar Horas</h2>
            <form onSubmit={handleCargarHoras}>
              <select 
                className="select"
                value={formHoras.proyecto}
                onChange={e => setFormHoras(prev => ({ ...prev, proyecto: e.target.value }))}
                required
              >
                {proyectos.map((p, i) => (
                  <option key={i} value={p.nombre}>{p.nombre}</option>
                ))}
              </select>
              <input 
                type="date" 
                className="input" 
                value={getFechaHoy()} 
                readOnly
                style={{ backgroundColor: "#f3f4f6", cursor: "not-allowed" }}
              />
              <input 
                type="number" 
                className="input" 
                placeholder="Horas trabajadas"
                min="1"
                value={formHoras.horas}
                onChange={e => setFormHoras(prev => ({ ...prev, horas: e.target.value }))}
                required
              />
              <textarea 
                className="input" 
                placeholder="Comentario (opcional)" 
                rows={3}
                style={{ resize: "vertical" }}
                value={formHoras.comentario}
                onChange={e => setFormHoras(prev => ({ ...prev, comentario: e.target.value }))}
              />
              <button className="button button-green" type="submit">Guardar</button>
            </form>
          </div>
        )}

        {/* Reportes */}
        {view === "reportes" && (
          <div className="table-container">
            <h2>Reportes</h2>
            <table>
              <thead>
                <tr>
                  <th>Empleado</th>
                  <th>Proyecto</th>
                  <th>Horas</th>
                </tr>
              </thead>
              <tbody>
                {reportes.map((r, idx) => (
                  <tr key={idx}>
                    <td>{r.empleado}</td>
                    <td>{r.proyecto}</td>
                    <td>{r.horas}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        )}

        {/* Perfil */}
        {view === "perfil" && (
          <div className="card">
            <h2>Mi Perfil</h2>
            <div className="profile-info">
              <p><b>Nombre:</b> {usuario.nombre}</p>
              <p><b>Email:</b> {empleados.find(e => e.nombre === usuario.nombre)?.email || "-"}</p>
              <p><b>Horas trabajadas:</b> 120</p>
              <p><b>Salario estimado:</b> $60,000</p>
            </div>
          </div>
        )}

        {/* Administrador */}
        {esAdmin && view === "admin" && (
          <div>
            <h2 style={{ color: "#7c3aed", fontWeight: "bold", marginBottom: 24 }}>Panel Administrador</h2>
            {/* Admin Tabs */}
            <div style={{ display: "flex", gap: "12px", marginBottom: "24px", flexWrap: "wrap" }}>
              <button
                className={`button${adminTab === "reportes" ? " active" : ""}`}
                style={{
                  width: "auto",
                  background: adminTab === "reportes" ? "#ede9fe" : "#fff",
                  color: adminTab === "reportes" ? "#7c3aed" : "#222",
                  border: "1px solid #ede9fe",
                }}
                onClick={() => setAdminTab("reportes")}
              >
                <FaClipboardList style={{ marginRight: 6 }} /> Reportes Generales
              </button>
              <button
                className={`button${adminTab === "empleados" ? " active" : ""}`}
                style={{
                  width: "auto",
                  background: adminTab === "empleados" ? "#ede9fe" : "#fff",
                  color: adminTab === "empleados" ? "#7c3aed" : "#222",
                  border: "1px solid #ede9fe",
                }}
                onClick={() => setAdminTab("empleados")}
              >
                <FaUsers style={{ marginRight: 6 }} /> Gestión de Empleados
              </button>
              <button
                className={`button${adminTab === "proyectos" ? " active" : ""}`}
                style={{
                  width: "auto",
                  background: adminTab === "proyectos" ? "#ede9fe" : "#fff",
                  color: adminTab === "proyectos" ? "#7c3aed" : "#222",
                  border: "1px solid #ede9fe",
                }}
                onClick={() => setAdminTab("proyectos")}
              >
                <FaProjectDiagram style={{ marginRight: 6 }} /> Gestión de Proyectos
              </button>
              <button
                className={`button${adminTab === "salarios" ? " active" : ""}`}
                style={{
                  width: "auto",
                  background: adminTab === "salarios" ? "#ede9fe" : "#fff",
                  color: adminTab === "salarios" ? "#7c3aed" : "#222",
                  border: "1px solid #ede9fe",
                }}
                onClick={() => setAdminTab("salarios")}
              >
                <FaMoneyBillWave style={{ marginRight: 6 }} /> Cálculo de Salarios
              </button>
            </div>
            
            {/* Admin Tab Content */}
            {adminTab === "reportes" && (
              <div className="table-container">
                <h2>Reportes Generales</h2>
                <table>
                  <thead>
                    <tr>
                      <th>Proyecto</th>
                      <th>Total Horas</th>
                      <th>Empleados</th>
                      <th>Estado</th>
                    </tr>
                  </thead>
                  <tbody>
                    {dedicacionPorProyecto.map((proy, idx) => (
                      <tr key={idx}>
                        <td>{proy.nombre}</td>
                        <td>{proy.empleados.reduce((sum, emp) => sum + emp.horas, 0)}</td>
                        <td>{proy.empleados.length}</td>
                        <td>
                          <span style={{ 
                            backgroundColor: getEstadoColor(proy.estado),
                            color: "white",
                            padding: "4px 8px",
                            borderRadius: "12px",
                            fontSize: "0.8rem"
                          }}>
                            {proy.estado}
                          </span>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            )}
            
            {adminTab === "empleados" && (
              <div className="table-container">
                <h2>Gestión de Empleados</h2>
                <table>
                  <thead>
                    <tr>
                      <th>Nombre</th>
                      <th>Email</th>
                      <th>Proyecto</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody>
                    {empleados.map((e, idx) => (
                      <tr key={idx}>
                        <td>{e.nombre}</td>
                        <td>{e.email}</td>
                        <td>{e.proyecto}</td>
                        <td>
                          <button className="button" style={{ width: "auto", padding: "6px 12px", fontSize: "0.9rem" }}
                            onClick={() => handleEditEmpleado(idx)}
                          >Editar</button>
                          <button className="button button-green" style={{ width: "auto", padding: "6px 12px", fontSize: "0.9rem", marginLeft: "6px" }}>Eliminar</button>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
                {/* Formulario de edición de empleados */}
                {editEmpleadoIdx !== null && (
                  <div className="card" style={{ marginTop: 24, background: "#ede9fe" }}>
                    <h2 style={{ color: "#7c3aed" }}>Editar Empleado</h2>
                    <input
                      className="input"
                      value={editEmpleadoData.nombre}
                      onChange={e => setEditEmpleadoData(data => ({ ...data, nombre: e.target.value }))}
                      placeholder="Nombre"
                    />
                    <input
                      className="input"
                      value={editEmpleadoData.email}
                      onChange={e => setEditEmpleadoData(data => ({ ...data, email: e.target.value }))}
                      placeholder="Email"
                    />
                    <select
                      className="select"
                      value={editEmpleadoData.proyecto}
                      onChange={e => setEditEmpleadoData(data => ({ ...data, proyecto: e.target.value }))}
                    >
                      {proyectos.map((p, i) => (
                        <option key={i} value={p.nombre}>{p.nombre}</option>
                      ))}
                    </select>
                    <div style={{ display: "flex", gap: 12 }}>
                      <button className="button" style={{ width: "auto" }} onClick={handleSaveEmpleado}>Guardar</button>
                      <button className="button button-green" style={{ width: "auto" }} onClick={handleCancelEdit}>Cancelar</button>
                    </div>
                  </div>
                )}
              </div>
            )}
            
            {adminTab === "proyectos" && (
              <div className="table-container">
                <h2>Gestión de Proyectos</h2>
                <table>
                  <thead>
                    <tr>
                      <th>Nombre</th>
                      <th>Estado</th>
                      <th>Empleados</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody>
                    {proyectos.map((proy, idx) => (
                      <tr key={idx}>
                        <td>{proy.nombre}</td>
                        <td>
                          <span style={{ 
                            backgroundColor: getEstadoColor(proy.estado),
                            color: "white",
                            padding: "4px 8px",
                            borderRadius: "12px",
                            fontSize: "0.8rem"
                          }}>
                            {proy.estado}
                          </span>
                        </td>
                        <td>{empleados.filter(e => e.proyecto === proy.nombre).length}</td>
                        <td>
                          <button 
                            className="button" 
                            style={{ width: "auto", padding: "6px 12px", fontSize: "0.9rem" }}
                            onClick={() => handleEditProyecto(idx)}
                          >
                            <FaEdit style={{ marginRight: 4 }} /> Editar
                          </button>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
                
                {/* Formulario de edición de proyectos */}
                {editProyectoIdx !== null && (
                  <div className="card" style={{ marginTop: 24, background: "#ede9fe" }}>
                    <h2 style={{ color: "#7c3aed" }}>Editar Proyecto</h2>
                    <input
                      className="input"
                      value={editProyectoData.nombre}
                      onChange={e => setEditProyectoData(data => ({ ...data, nombre: e.target.value }))}
                      placeholder="Nombre del proyecto"
                    />
                    <select
                      className="select"
                      value={editProyectoData.estado}
                      onChange={e => setEditProyectoData(data => ({ ...data, estado: e.target.value }))}
                    >
                      {estadosProyecto.map((estado, i) => (
                        <option key={i} value={estado}>{estado}</option>
                      ))}
                    </select>
                    <div style={{ 
                      width: "100%", 
                      height: "8px", 
                      backgroundColor: "#e5e7eb", 
                      borderRadius: "4px",
                      marginBottom: "16px",
                      overflow: "hidden"
                    }}>
                      <div 
                        style={{ 
                          width: `${getEstadoProgreso(editProyectoData.estado)}%`, 
                          height: "100%", 
                          backgroundColor: getEstadoColor(editProyectoData.estado),
                          transition: "all 0.3s ease"
                        }} 
                      />
                    </div>
                    <div style={{ display: "flex", gap: 12 }}>
                      <button className="button" style={{ width: "auto" }} onClick={handleSaveProyecto}>
                        <FaSave style={{ marginRight: 4 }} /> Guardar
                      </button>
                      <button className="button button-green" style={{ width: "auto" }} onClick={handleCancelEditProyecto}>
                        <FaTimes style={{ marginRight: 4 }} /> Cancelar
                      </button>
                    </div>
                  </div>
                )}
              </div>
            )}
            
            {adminTab === "salarios" && (
              <div className="table-container">
                <h2>Cálculo de Salarios</h2>
                <table>
                  <thead>
                    <tr>
                      <th>Empleado</th>
                      <th>Horas trabajadas</th>
                      <th>Salario por hora</th>
                      <th>Salario total</th>
                    </tr>
                  </thead>
                  <tbody>
                    {empleados.map((e, idx) => {
                      const horas = reportes.filter(r => r.empleado === e.nombre).reduce((sum, r) => sum + r.horas, 0);
                      const salarioHora = salarios[e.nombre] || 0;
                      const salarioTotal = horas * salarioHora;
                      return (
                        <tr key={idx}>
                          <td>{e.nombre}</td>
                          <td>{horas}</td>
                          <td>
                            <input
                              type="number"
                              value={salarioHora}
                              min="0"
                              style={{ width: 80, padding: "4px", borderRadius: 6, border: "1px solid #ddd" }}
                              onChange={ev => handleSalarioChange(e.nombre, ev.target.value)}
                            />
                          </td>
                          <td>${salarioTotal.toLocaleString()}</td>
                        </tr>
                      );
                    })}
                  </tbody>
                </table>
              </div>
            )}
          </div>
        )}
      </main>
    </div>
  );
}

export default Dashboard;
